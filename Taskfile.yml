version: '3'

dotenv: ['.env', '{{.ENV}}/.env.', '{{.HOME}}/.env']

tasks:
  init:
    cmds:
    - cd main-infra && terraform init
  deploy:
    cmds:
    - cd main-infra && terraform apply
  destroy:
    - cd main-infra && terraform destroy

  invoke-gateway:
    cmds:
    - curl "https://oefjjuylog.execute-api.us-east-1.amazonaws.com/serverless_lambda_stage/hello"

  setup:
    cmds:
    - task: init
    - task: deploy
    - task: invoke-gateway
